<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Hustlepay - Dashboard</title>
<link rel="stylesheet" href="dashboard.css">
</head>
<body>

  
<header class="top-bar">
  <div class="logo-container">
    <img src="logo.gif" alt="Logo" class="logo">
    <span class="site-name">HustlePay</span>
  </div>
  <button class="logout" id="logoutBtn">Logout</button>
</header>

<!-- Popup -->
<div class="popup" id="popup">
  <div class="popup-content">
    <h2>Welcome home!</h2>
    <p>Hi userðŸ˜‰, <br> Welcome to HustlePay, in HustlePay you earn by completing simple tasks, watching short videos and also subscribing. you can also create your own task which would be verified before it shows in the task page. Earn when people click your link. Share your referral code to be eligable to withdraw. The minimum withdraw is â‚¦1500. Isn't it amazing? You can also withdraw in airtime. <br> <i>You are adviced to Join the Skyline Whatsapp Channel for successful withdraw.</i> Thanks for using HustlePay.</p>
    <button class="join-btn" onclick="joinNow()">Join</button>
    <button class="close-btn" onclick="closePopup()">Close</button>
  </div>
</div>


<div class="container">
  <div class="card">
    <strong>Hi,</strong> <span id="email"></span><br>
    <strong>Joined:</strong> <span id="created"></span>
  </div>

  <div class="stats">
    <div class="stat"><h3 id="balance">â‚¦0</h3><small>Earnings</small></div>
    <div class="stat"><h3 id="clicks">0</h3><small>Clicks</small></div>
    <div class="stat"><h3 id="referrals">0</h3><small>Referrals</small></div>
    <div class="stat"><h3 id="videos">0</h3><small>Videos Watched</small></div>
    <div class="stat"><h3 id="tasks">0</h3><small>Tasks Completed</small></div>
  </div>

  <div class="card">
    <h4>My Referral Link</h4>
    <div class="referral" id="refLink"></div>
    <button id="copyBtn">Copy</button>
  </div>
</div>

<div class="cont">
  <div class="first-cont">
  <img src="comming-soon-referral.png" alt="referrals">
  <p>Having referrals makes it easy and fast for you to withdraw your earnings.</p>
  </div>
  <!-- 2 -->
   <div class="first-cont2">
  <img src="comming-soon-task.png" alt="referrals">
  <p>Perform our simple tasks to have more earnings. Some have higher rewards.</p>
  </div>
  <!-- 3 -->
   <div class="first-cont">
  <img src="comming-soon-video.png" alt="referrals">
  <p>Watch our vidoes to add some cash to your balance. </p>
  </div>
</div>

<div class="bottom-nav"> 
  <a href="dashboard.html"   class="active">
    <svg width="24" height="24" fill="currentColor"><path d="M3 12l9-9 9 9v9a1 1 0 0 1-1 1h-5v-6h-6v6H4a1 1 0 0 1-1-1z"/></svg>
    Home
  </a>
  <a href="videos.html">
    <svg width="24" height="24" fill="currentColor"><path d="M10 8.64v6.72L15 12l-5-3.36z"/><path d="M21 3H3v18h18V3zM5 19V5h14v14H5z"/></svg>
    Videos
  </a>
    <a href="create.html" > 
  <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10
             10-4.48 10-10S17.52 2 12 2zm1 11h4v-2h-4V7h-2v4H7v2h4v4h2v-4z"/>
  </svg>
  Create
</a>
  <a href="tasks.html" >
    <svg width="24" height="24" fill="currentColor"><path d="M9 11H7v2h2v-2zm0-4H7v2h2V7zm4 4h8v2h-8v-2zm0-4h8v2h-8V7zm-4 8H7v2h2v-2zm4 0h8v2h-8v-2z"/></svg>
    Tasks
  </a>
  <a href="profile.html">
    <svg width="24" height="24" fill="currentColor"><path d="M12 12c2.7 0 5-2.3 5-5s-2.3-5-5-5-5 2.3-5 5 2.3 5 5 5zm0 2c-3.3 0-10 1.7-10 5v3h20v-3c0-3.3-6.7-5-10-5z"/></svg>
    Profile
  </a>
</div>

<script src="dash.js"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDim9k5CHfNythq6ORypN_RfwyLNMuxVLs",
  authDomain: "sign-2fd98.firebaseapp.com",
  projectId: "sign-2fd98",
  storageBucket: "sign-2fd98.appspot.com",
  messagingSenderId: "548682903618",
  appId: "1:548682903618:web:0f0ca286f902c7fbacfddb"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth();
const db = getFirestore(app);

onAuthStateChanged(auth, async (user) => {
  if (user) {
    const uid = user.uid;
    const docRef = doc(db, "users", uid);
    const docSnap = await getDoc(docRef);

    if (docSnap.exists()) {
      const data = docSnap.data();
      document.getElementById("email").textContent = user.email;
      document.getElementById("balance").textContent = "â‚¦" + (data.balance || 0).toLocaleString();
      document.getElementById("clicks").textContent = data.clicks || 0;
      document.getElementById("referrals").textContent = data.referrals || 0;
      document.getElementById("videos").textContent = data.videos || 0;
      document.getElementById("tasks").textContent = data.tasks || 0;
      document.getElementById("created").textContent = data.createdAt
        ? data.createdAt.toDate().toDateString()
        : "N/A";
      document.getElementById("refLink").textContent = `https://samaxin01.github.io/sky2/index.html?ref=${data.referralCode || "N/A"}`;
    } else {
      alert("No user data found.");
    }
  } else {
    window.location.href = "login.html";
  }
});

// Logout
document.getElementById("logoutBtn").onclick = () => {
  signOut(auth).then(() => {
    window.location.href = "login.html";
  });
};

// Get references to DOM elements
        const popupContainer = document.getElementById('popupContainer');
        const closePopupButton = document.getElementById('closePopupButton');
        const okButton = document.getElementById('okButton'); // Get the 'Got it!' button

        /**
         * Shows the pop-up message with a fade-in and slide-down animation.
         */
        function showPopup() {
            // Add 'active' class to trigger fade-in and slide-down
            popupContainer.classList.add('active');
            // Remove 'hide' class if it was previously added
            popupContainer.classList.remove('hide');
        }

        /**
         * Hides the pop-up message with a fade-out and slide-up animation.
         * The 'hide' class is added first to trigger the animation,
         * then after a delay (matching CSS transition duration), the 'active'
         * class is removed and visibility is set to hidden.
         */
        function hidePopup() {
            // Add 'hide' class to trigger fade-out and slide-up animation
            popupContainer.classList.add('hide');

            // After the animation completes, remove 'active' and 'hide' classes
            // to fully hide the element and reset its state.
            // The delay should match the CSS transition duration (0.3s).
            setTimeout(() => {
                popupContainer.classList.remove('active');
                popupContainer.classList.remove('hide');
            }, 300); // 300ms matches the CSS transition duration
        }

        // Add event listener to the close button inside the pop-up
        closePopupButton.addEventListener('click', hidePopup);

        // Add event listener to the 'Got it!' button inside the pop-up
        okButton.addEventListener('click', hidePopup);

        // Optional: Close pop-up when clicking outside the content area
        popupContainer.addEventListener('click', (event) => {
            // If the click target is the container itself (not a child of popup-content)
            if (event.target === popupContainer) {
                hidePopup();
            }
        });

        // Automatically show the pop-up after 3 seconds when the page loads
        window.onload = function() {
            setTimeout(showPopup, 3000); // 3000 milliseconds = 3 seconds
        };


// Copy referral link
document.getElementById("copyBtn").addEventListener("click", () => {
  const link = document.getElementById("refLink").textContent;
  navigator.clipboard.writeText(link);
  alert("Referral link copied!");
});
</script>
</body>
</html>
